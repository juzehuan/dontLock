# 防止电脑锁屏工具

一个使用 Python 开发的防止电脑自动锁屏的工具，具有 GUI 界面、任务栏托盘图标、开机自启等功能。

## 功能特点

- 🖥️ **GUI 界面**：简洁直观的图形用户界面
- 📋 **任务栏托盘图标**：支持最小化到系统托盘
- 🔄 **开机自启**：可设置开机自动启动
- ⏱️ **自定义间隔**：支持设置防止锁屏的时间间隔
- 📝 **日志记录**：实时记录软件运行状态
- 🚪 **优雅退出**：支持正常退出和托盘退出

## 技术栈

- Python 3.8+
- tkinter (GUI 界面)
- PIL/Pillow (图像处理)
- pystray (系统托盘)
- pyinstaller (打包工具)

## 安装依赖

```bash
pip install -r requirements.txt
```

## 使用方法

### 1. 直接运行

```bash
python prevent_lock.py
```

### 2. 打包成 EXE 程序

#### 方法一：使用 PyInstaller 命令

```bash
pyinstaller --onefile --windowed --name "防止锁屏工具" prevent_lock.py
```

#### 方法二：使用打包配置文件

```bash
pyinstaller prevent_lock.spec
```

打包完成后，可执行文件将生成在 `dist` 目录下。

## 功能说明

### 主界面

1. **当前状态**：显示软件的运行状态（未运行/运行中/已停止）
2. **活动间隔**：设置防止锁屏的时间间隔（单位：秒，最小值为 10 秒）
3. **开机自启**：勾选后，软件将在电脑开机时自动启动
4. **运行日志**：显示最近 10 条运行日志
5. **开始/停止按钮**：控制防止锁屏功能的开启和关闭

### 系统托盘

软件启动后，会在系统托盘中显示一个蓝色图标，右键点击图标可进行以下操作：

- **显示主窗口**：打开软件的主界面
- **开始**：开始防止锁屏功能
- **停止**：停止防止锁屏功能
- **退出**：完全退出软件

### 窗口操作

- 点击窗口右上角的关闭按钮，软件将最小化到系统托盘，不会完全退出
- 要完全退出软件，请通过系统托盘的「退出」选项

## 工作原理

软件通过调用 Windows API 中的 `SetThreadExecutionState` 函数，设置 `ES_CONTINUOUS | ES_DISPLAY_REQUIRED` 标志，告诉系统持续保持显示器开启状态，从而防止系统自动锁屏。

当软件停止或退出时，会恢复系统的默认设置。

## 注意事项

1. **管理员权限**：某些系统可能需要以管理员身份运行才能正常工作
2. **杀毒软件**：部分杀毒软件可能会误报，建议添加到白名单
3. **资源占用**：软件运行时资源占用极低，不会影响电脑性能
4. **间隔设置**：建议将时间间隔设置为 30-60 秒，过短可能会影响系统性能
5. **退出方式**：请使用软件提供的退出功能，不要直接结束进程

## 适用场景

- 观看视频时防止锁屏
- 演示文稿时防止锁屏
- 下载大文件时防止锁屏
- 长时间运行程序时防止锁屏
- 其他需要保持电脑唤醒状态的场景

## 常见问题

### Q: 软件运行后没有效果？
A: 请尝试以管理员身份运行软件，或检查系统电源设置。

### Q: 软件无法开机自启？
A: 请检查系统的启动项管理，确保软件被允许开机自启。

### Q: 如何完全退出软件？
A: 右键点击系统托盘图标，选择「退出」选项。

### Q: 日志文件在哪里？
A: 日志文件 `prevent_lock.log` 位于软件运行目录下。

## 许可证

MIT License

## 更新日志

### v1.0.0 (2026-01-16)
- 初始版本
- 实现基本的防止锁屏功能
- 添加 GUI 界面和系统托盘
- 支持开机自启
- 支持自定义时间间隔
- 支持日志记录
